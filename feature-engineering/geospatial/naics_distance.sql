select  
        map.gid as coloniaid,l.*
from
        colonias_centroid as map, LATERAL
        (
        select

SUM(CASE WHEN distance < 2500 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_0_2_5k,
SUM(CASE WHEN distance < 5000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_5k,
SUM(CASE WHEN distance < 10000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_10k,
SUM(CASE WHEN distance < 15000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_15k,
SUM(CASE WHEN distance < 20000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_20k,
SUM(CASE WHEN distance < 25000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_25k,
SUM(CASE WHEN distance < 30000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_30k,
SUM(CASE WHEN distance < 35000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_35k,
SUM(CASE WHEN distance < 40000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_40k,
SUM(CASE WHEN distance < 45000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_45k,
SUM(CASE WHEN distance < 50000  and (clase_act like ''6111%'')  THEN no_employee ELSE 0 END) no_employee_6111_0_50k,
SUM(CASE WHEN distance < 2500  and (clase_act like ''6111%'')THEN 1 ELSE 0 END) no_businesses_6111_0_2_5k,
SUM(CASE WHEN distance < 5000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_5k,
SUM(CASE WHEN distance < 10000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_10k,
SUM(CASE WHEN distance < 15000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_15k,
SUM(CASE WHEN distance < 20000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_20k,
SUM(CASE WHEN distance < 25000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_25k,
SUM(CASE WHEN distance < 30000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_30k,
SUM(CASE WHEN distance < 35000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_35k,
SUM(CASE WHEN distance < 40000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_40k,
SUM(CASE WHEN distance < 45000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_45k,
SUM(CASE WHEN distance < 50000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_0_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''6111%'') THEN no_employee ELSE 0 END) no_employee_6111_45_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''6111%'') THEN 1 ELSE 0 END) no_businesses_6111_45_50k,
SUM(CASE WHEN distance < 2500 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_0_2_5k,
SUM(CASE WHEN distance < 5000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_5k,
SUM(CASE WHEN distance < 10000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_10k,
SUM(CASE WHEN distance < 15000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_15k,
SUM(CASE WHEN distance < 20000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_20k,
SUM(CASE WHEN distance < 25000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_25k,
SUM(CASE WHEN distance < 30000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_30k,
SUM(CASE WHEN distance < 35000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_35k,
SUM(CASE WHEN distance < 40000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_40k,
SUM(CASE WHEN distance < 45000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_45k,
SUM(CASE WHEN distance < 50000  and (clase_act like ''622%'')  THEN no_employee ELSE 0 END) no_employee_622_0_50k,
SUM(CASE WHEN distance < 2500  and (clase_act like ''622%'')THEN 1 ELSE 0 END) no_businesses_622_0_2_5k,
SUM(CASE WHEN distance < 5000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_5k,
SUM(CASE WHEN distance < 10000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_10k,
SUM(CASE WHEN distance < 15000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_15k,
SUM(CASE WHEN distance < 20000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_20k,
SUM(CASE WHEN distance < 25000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_25k,
SUM(CASE WHEN distance < 30000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_30k,
SUM(CASE WHEN distance < 35000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_35k,
SUM(CASE WHEN distance < 40000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_40k,
SUM(CASE WHEN distance < 45000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_45k,
SUM(CASE WHEN distance < 50000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_0_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''622%'') THEN no_employee ELSE 0 END) no_employee_622_45_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''622%'') THEN 1 ELSE 0 END) no_businesses_622_45_50k,
SUM(CASE WHEN distance < 2500 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_0_2_5k,
SUM(CASE WHEN distance < 5000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_5k,
SUM(CASE WHEN distance < 10000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_10k,
SUM(CASE WHEN distance < 15000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_15k,
SUM(CASE WHEN distance < 20000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_20k,
SUM(CASE WHEN distance < 25000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_25k,
SUM(CASE WHEN distance < 30000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_30k,
SUM(CASE WHEN distance < 35000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_35k,
SUM(CASE WHEN distance < 40000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_40k,
SUM(CASE WHEN distance < 45000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_45k,
SUM(CASE WHEN distance < 50000  and (clase_act like ''461%'')  THEN no_employee ELSE 0 END) no_employee_461_0_50k,
SUM(CASE WHEN distance < 2500  and (clase_act like ''461%'')THEN 1 ELSE 0 END) no_businesses_461_0_2_5k,
SUM(CASE WHEN distance < 5000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_5k,
SUM(CASE WHEN distance < 10000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_10k,
SUM(CASE WHEN distance < 15000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_15k,
SUM(CASE WHEN distance < 20000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_20k,
SUM(CASE WHEN distance < 25000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_25k,
SUM(CASE WHEN distance < 30000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_30k,
SUM(CASE WHEN distance < 35000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_35k,
SUM(CASE WHEN distance < 40000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_40k,
SUM(CASE WHEN distance < 45000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_45k,
SUM(CASE WHEN distance < 50000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_0_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''461%'') THEN no_employee ELSE 0 END) no_employee_461_45_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''461%'') THEN 1 ELSE 0 END) no_businesses_461_45_50k,
SUM(CASE WHEN distance < 2500 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_0_2_5k,
SUM(CASE WHEN distance < 5000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_5k,
SUM(CASE WHEN distance < 10000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_10k,
SUM(CASE WHEN distance < 15000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_15k,
SUM(CASE WHEN distance < 20000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_20k,
SUM(CASE WHEN distance < 25000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_25k,
SUM(CASE WHEN distance < 30000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_30k,
SUM(CASE WHEN distance < 35000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_35k,
SUM(CASE WHEN distance < 40000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_40k,
SUM(CASE WHEN distance < 45000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_45k,
SUM(CASE WHEN distance < 50000  and (clase_act like ''46211%'')  THEN no_employee ELSE 0 END) no_employee_46211_0_50k,
SUM(CASE WHEN distance < 2500  and (clase_act like ''46211%'')THEN 1 ELSE 0 END) no_businesses_46211_0_2_5k,
SUM(CASE WHEN distance < 5000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_5k,
SUM(CASE WHEN distance < 10000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_10k,
SUM(CASE WHEN distance < 15000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_15k,
SUM(CASE WHEN distance < 20000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_20k,
SUM(CASE WHEN distance < 25000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_25k,
SUM(CASE WHEN distance < 30000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_30k,
SUM(CASE WHEN distance < 35000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_35k,
SUM(CASE WHEN distance < 40000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_40k,
SUM(CASE WHEN distance < 45000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_45k,
SUM(CASE WHEN distance < 50000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_0_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''46211%'') THEN no_employee ELSE 0 END) no_employee_46211_45_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''46211%'') THEN 1 ELSE 0 END) no_businesses_46211_45_50k,
SUM(CASE WHEN distance < 2500 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_0_2_5k,
SUM(CASE WHEN distance < 5000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_5k,
SUM(CASE WHEN distance < 10000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_10k,
SUM(CASE WHEN distance < 15000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_15k,
SUM(CASE WHEN distance < 20000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_20k,
SUM(CASE WHEN distance < 25000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_25k,
SUM(CASE WHEN distance < 30000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_30k,
SUM(CASE WHEN distance < 35000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_35k,
SUM(CASE WHEN distance < 40000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_40k,
SUM(CASE WHEN distance < 45000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_45k,
SUM(CASE WHEN distance < 50000  and (clase_act like ''722%'')  THEN no_employee ELSE 0 END) no_employee_722_0_50k,
SUM(CASE WHEN distance < 2500  and (clase_act like ''722%'')THEN 1 ELSE 0 END) no_businesses_722_0_2_5k,
SUM(CASE WHEN distance < 5000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_5k,
SUM(CASE WHEN distance < 10000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_10k,
SUM(CASE WHEN distance < 15000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_15k,
SUM(CASE WHEN distance < 20000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_20k,
SUM(CASE WHEN distance < 25000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_25k,
SUM(CASE WHEN distance < 30000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_30k,
SUM(CASE WHEN distance < 35000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_35k,
SUM(CASE WHEN distance < 40000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_40k,
SUM(CASE WHEN distance < 45000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_45k,
SUM(CASE WHEN distance < 50000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_0_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''722%'') THEN no_employee ELSE 0 END) no_employee_722_45_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''722%'') THEN 1 ELSE 0 END) no_businesses_722_45_50k,
SUM(CASE WHEN distance < 2500 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_0_2_5k,
SUM(CASE WHEN distance < 5000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_5k,
SUM(CASE WHEN distance < 10000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_10k,
SUM(CASE WHEN distance < 15000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_15k,
SUM(CASE WHEN distance < 20000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_20k,
SUM(CASE WHEN distance < 25000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_25k,
SUM(CASE WHEN distance < 30000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_30k,
SUM(CASE WHEN distance < 35000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_35k,
SUM(CASE WHEN distance < 40000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_40k,
SUM(CASE WHEN distance < 45000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_45k,
SUM(CASE WHEN distance < 50000  and (clase_act like ''81321%'')  THEN no_employee ELSE 0 END) no_employee_81321_0_50k,
SUM(CASE WHEN distance < 2500  and (clase_act like ''81321%'')THEN 1 ELSE 0 END) no_businesses_81321_0_2_5k,
SUM(CASE WHEN distance < 5000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_5k,
SUM(CASE WHEN distance < 10000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_10k,
SUM(CASE WHEN distance < 15000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_15k,
SUM(CASE WHEN distance < 20000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_20k,
SUM(CASE WHEN distance < 25000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_25k,
SUM(CASE WHEN distance < 30000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_30k,
SUM(CASE WHEN distance < 35000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_35k,
SUM(CASE WHEN distance < 40000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_40k,
SUM(CASE WHEN distance < 45000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_45k,
SUM(CASE WHEN distance < 50000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_0_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''81321%'') THEN no_employee ELSE 0 END) no_employee_81321_45_50k,
SUM(CASE WHEN distance >= 2500 and distance < 5000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_2_5_5k,
SUM(CASE WHEN distance >= 5000 and distance < 10000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_5_10k,
SUM(CASE WHEN distance >= 10000 and distance < 15000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_10_15k,
SUM(CASE WHEN distance >= 15000 and distance < 20000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_15_20k,
SUM(CASE WHEN distance >= 20000 and distance < 25000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_20_25k,
SUM(CASE WHEN distance >= 25000 and distance < 30000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_25_30k,
SUM(CASE WHEN distance >= 30000 and distance < 35000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_30_35k,
SUM(CASE WHEN distance >= 35000 and distance < 40000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_35_40k,
SUM(CASE WHEN distance >= 40000 and distance < 45000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_40_45k,
SUM(CASE WHEN distance >= 45000 and distance < 50000 and (clase_act like ''81321%'') THEN 1 ELSE 0 END) no_businesses_81321_45_50k

                from (
                select
                        internal_map.gid as mapgid,
                        denue.gid,
                        no_employee,
                        ST_Distance_Spheroid(denue.geom,map.geom,''SPHEROID["WGS 84",6378137,298.257223563]'') as distance,
                        clase_act
                from
                        denue2010 as denue, --TODO replace in script
                        colonias_centroid as internal_map
                Where
                        internal_map.gid=map.gid and ST_DWithin(denue.geom,map.geom,0.5)
                group by
                        internal_map.gid,
                        denue.gid
                        ) as distances
        group by mapgid) l


where
        (1=1)
